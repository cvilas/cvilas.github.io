<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ObjectManager Class Reference</title>
<link href="stylesheet.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.3 on Thu Aug 16 21:55:44 2001 -->
<h1>ObjectManager  Class Reference</h1>Manages all robotic objects created. 
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="ObjectManager_hpp-source.html">ObjectManager.hpp</a>&gt;</code>
<p>
<a href="class_ObjectManager-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td colspan=2><br><h2>Public Methods</h2></td></tr>
<tr><td nowrap align=right valign=top>&nbsp;</td><td valign=bottom><a class="el" href="class_ObjectManager.html#a0">ObjectManager</a> ()</td></tr>
<tr><td nowrap align=right valign=top>&nbsp;</td><td valign=bottom><a class="el" href="class_ObjectManager.html#a1">~ObjectManager</a> ()</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="class_ObjectManager.html#a2">listAllObjects</a> (ostream &amp;output = cout) const</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="class_ObjectManager.html#a3">getNumObjects</a> () const</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="class_RoboticObject.html">RoboticObject</a>*&nbsp;</td><td valign=bottom><a class="el" href="class_ObjectManager.html#a4">getObjectByIndex</a> (int objectIndex) const</td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="class_RoboticObject.html">RoboticObject</a>*&nbsp;</td><td valign=bottom><a class="el" href="class_ObjectManager.html#a5">getObjectByName</a> (const char *objectName) const</td></tr>
<tr><td nowrap align=right valign=top>bool&nbsp;</td><td valign=bottom><a class="el" href="class_ObjectManager.html#a6">isValidObjectPointer</a> (<a class="el" href="class_RoboticObject.html">RoboticObject</a> *object) const</td></tr>
<tr><td nowrap align=right valign=top>template&lt;classT&gt; T*&nbsp;</td><td valign=bottom><a class="el" href="class_ObjectManager.html#a7">createDerivedObject</a> (const char *objectName)</td></tr>
<tr><td nowrap align=right valign=top>template&lt;classT&gt; T*&nbsp;</td><td valign=bottom><a class="el" href="class_ObjectManager.html#a8">createDerivedObject</a> (int i = 1)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="class_ObjectManager.html#a9">lockForRead</a> () const</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="class_ObjectManager.html#a10">unlock</a> () const</td></tr>
<tr><td colspan=2><br><h2>Public Attributes</h2></td></tr>
<tr><td nowrap align=right valign=top>Status&nbsp;</td><td valign=bottom><a class="el" href="class_ObjectManager.html#m0">d_status</a></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Manages all robotic objects created.
<p>
The class ObjectManager manages all objects of the class <a class="el" href="class_RoboticObject.html">RoboticObject</a> and derived classes. It maintains a list of all currently allocated objects. Construction (call of  <a class="el" href="class_RoboticObject.html#b1">RoboticObject::init</a>()) of an object will add it to the object list of the object manager. Destruction (call of <a class="el" href="class_RoboticObject.html#b3">RoboticObject::exit</a>()) of an object will remove it from the object list. Different functions provide random access to the list of objects.
<p>
The user has to be very careful when operating on objects that were returned by the object manager. Another thread can create and delete objects any time. The mutual exclusion functions must be used when operating on objects of the object manager. Specifically, lockDeletion() has to be called before an object pointer that was returned by the object manager is used. After the object access is finished, unlockDeletion() must be called.
<p>
The object list is static. Hence, any number of ObjectManager objects can be created that all access the same list.
<p>
<b>Example Program:</b>
<p>
<div class="fragment"><pre><font class="comment">//======================================================================== </font>
<font class="comment">// Project: Robotic Platform</font>
<font class="comment">// ---------------------------------------------------------------------- </font>
<font class="comment">// Package: Core Classes</font>
<font class="comment">// Authors: Markus Loffler</font>
<font class="comment">// Start Date: Mon Nov 20 16:09:19 utc 2000</font>
<font class="comment">// ----------------------------------------------------------------------  </font>
<font class="comment">// File: ObjectManager.t.cpp</font>
<font class="comment">// Example program for the class ObjectManager.</font>
<font class="comment">//========================================================================  </font>
 

<font class="comment">// ----- Standard Libaries -----</font>
<font class="preprocessor">#include &lt;iostream.h&gt;</font>

<font class="comment">// ----- QRTS Libraries -----</font>

<font class="comment">// ----- Project Includes -----</font>
<font class="preprocessor">#include "ObjectManager.hpp"</font>
<font class="preprocessor">#include "TypeInfo.hpp"</font>
<font class="preprocessor">#include "PhysicalObject.hpp"</font>

<font class="comment">/*</font>
<font class="comment">#include "Puma560.hpp"</font>
<font class="comment">#include "WAM.hpp"</font>
<font class="comment">#include "DefaultGripper.hpp"</font>
<font class="comment">#include "DefaultTrajectoryGenerator.hpp"</font>
<font class="comment">#include "BarrettHand.hpp"</font>
<font class="comment">#include "ServoControl.hpp"</font>
<font class="comment">*/</font>
 
 
<font class="comment">//======================================================================== </font>
<font class="comment">// main</font>
<font class="comment">//========================================================================  </font>
 
<font class="keywordtype">int</font> main(<font class="keywordtype">int</font> argc, <font class="keywordtype">char</font> *argv[])<font class="keyword"></font>
<font class="keyword"></font>{
  <a class="code" href="class_RoboticPlatform.html#d1">RoboticPlatform::init</a>(argc, argv);

  <a class="code" href="class_ObjectManager.html">ObjectManager</a> om;
  
  <font class="comment">// Create a couple of objects</font>
<font class="comment">/* !!!  Puma560 puma;</font>
<font class="comment">  puma.setName("My Puma");</font>
<font class="comment">  WAM wam, wam2;</font>
<font class="comment">  DefaultTrajectoryGenerator tragen;</font>
<font class="comment">  ServoControl&lt;6&gt; sc;</font>
<font class="comment">  DefaultGripper gripper1;</font>
<font class="comment">  BarrettHand gripper2;*/</font>
  
  <font class="comment">// List all objects</font>
  om.<a class="code" href="class_ObjectManager.html#a2">listAllObjects</a>();
  
  <font class="comment">// List all physical objects</font>
  cout &lt;&lt; <font class="stringliteral">"Physical objects only:"</font> &lt;&lt; endl;
  om.<a class="code" href="class_ObjectManager.html#a9">lockForRead</a>();  <font class="comment">// Always first!</font>
  <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i &lt; om.<a class="code" href="class_ObjectManager.html#a3">getNumObjects</a>(); i++)
  {
    <a class="code" href="class_RoboticObject.html">RoboticObject</a> *object = om.<a class="code" href="class_ObjectManager.html#a4">getObjectByIndex</a>(i);
    <font class="keywordflow">if</font> (object-&gt;<a class="code" href="class_RoboticObject.html#a6">getTypeInfo</a>()-&gt;<a class="code" href="class_TypeInfo.html#a6">isDerivedFromClass</a>(&amp;PhysicalObject::s_typeInfo))
    {
      cout &lt;&lt; object-&gt;getTypeInfo()-&gt;getClassName() &lt;&lt; <font class="stringliteral">" "</font>
           &lt;&lt; object-&gt;<a class="code" href="class_RoboticObject.html#a2">getName</a>() &lt;&lt; endl;
    }
  }
  om.<a class="code" href="class_ObjectManager.html#a10">unlock</a>();
  
  <font class="comment">// Find object by name</font>
  cout &lt;&lt; <font class="stringliteral">"Type in an object name to shutdown object ==&gt; "</font>;
  <font class="keywordtype">char</font> objectName[100];
  cin &gt;&gt; objectName;
  
  <a class="code" href="class_RoboticObject.html">RoboticObject</a> *object = om.<a class="code" href="class_ObjectManager.html#a5">getObjectByName</a>(objectName);
  <font class="keywordflow">if</font> (object == 0)
    cout &lt;&lt; <font class="stringliteral">"Didn't find object with name "</font> &lt;&lt; objectName &lt;&lt; endl;
  <font class="keywordflow">else</font>
  {
    cout &lt;&lt; <font class="stringliteral">"Shutting down "</font> &lt;&lt; objectName &lt;&lt; endl;
    object-&gt;<a class="code" href="class_RoboticObject.html#a7">startShutdown</a>();
  }
  
  <font class="keywordflow">return</font> 0;
}


<font class="comment">/* --------------- Program Output --------------- </font>
<font class="comment"></font>
<font class="comment">List of objects:</font>
<font class="comment">- [Puma560] MyPuma</font>
<font class="comment">- [WAM] WAM 1</font>
<font class="comment">- [WAM] WAM 2</font>
<font class="comment">- [DefaultTrajectoryGenerator] DefaultTrajectoryGenerator 1</font>
<font class="comment">- [ServoControl&lt;6&gt;] ServoControl&lt;6&gt; 1</font>
<font class="comment">- [DefaultGripper] DefaultGripper 1</font>
<font class="comment">- [BarrettHand] BarrettHand 1</font>
<font class="comment"></font>
<font class="comment">Physical objects only:</font>
<font class="comment">Puma560 MyPuma</font>
<font class="comment">WAM WAM 1</font>
<font class="comment">WAM WAM 2</font>
<font class="comment">DefaultGripper DefaultGripper 1</font>
<font class="comment">BarrettHand BarrettHand 1</font>
<font class="comment"></font>
<font class="comment">Type in an object name ==&gt; DefaultGripper 1</font>
<font class="comment">The object DefaultGripper 1 is of the class DefaultGripper</font>
<font class="comment"></font>
<font class="comment">------------------------------------------------*/</font>
</div></pre> 
<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a name="a0" doxytag="ObjectManager::ObjectManager"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
ObjectManager (
          </b></td>
          <td valign="bottom"><b>
)
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Default constructor.     </td>
  </tr>
</table>
<a name="a1" doxytag="ObjectManager::~ObjectManager"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
~ObjectManager (
          </b></td>
          <td valign="bottom"><b>
)
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Default destructor.     </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a name="a2" doxytag="ObjectManager::listAllObjects"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
void listAllObjects (
          </b></td>
          <td valign="bottom"><b>
ostream &amp; <em>output</em> = cout&nbsp;) const
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This is a debugging function. It lists all objects that are currently registered with the object manager.
<p>
Note: Do not call this function if you have locked the object manager with a call of <a class="el" href="class_ObjectManager.html#a9">lockForRead</a>() and haven't unlocked it yet. <dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>output</em>
&nbsp;</td><td>
 Output stream to write the list to. </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a name="a3" doxytag="ObjectManager::getNumObjects"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
int getNumObjects (
          </b></td>
          <td valign="bottom"><b>
) const
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the number of objects currently registered with the object manager. <dl compact><dt>
<b>Returns: </b><dd>
 The number of objects. </dl>    </td>
  </tr>
</table>
<a name="a4" doxytag="ObjectManager::getObjectByIndex"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
<a class="el" href="class_RoboticObject.html">RoboticObject</a> * getObjectByIndex (
          </b></td>
          <td valign="bottom"><b>
int <em>objectIndex</em>&nbsp;) const
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns an object from the object list. Important: Call lockDeletion() before this function, otherwise any other thread can delete the object before you will be able to use it. <dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>objectIndex</em>
&nbsp;</td><td>
 The number of the object in the list. </td></tr>
</table>
</dl><dl compact><dt>
<b>Returns: </b><dd>
 A pointer to the object or 0, if the index was out of range. </dl>    </td>
  </tr>
</table>
<a name="a5" doxytag="ObjectManager::getObjectByName"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
<a class="el" href="class_RoboticObject.html">RoboticObject</a> * getObjectByName (
          </b></td>
          <td valign="bottom"><b>
const char * <em>objectName</em>&nbsp;) const
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns an object from the object list. Important: Call lockDeletion() before this function, otherwise any other thread can delete the object before you will be able to use it. <dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>objectName</em>
&nbsp;</td><td>
 The name of the object. </td></tr>
</table>
</dl><dl compact><dt>
<b>Returns: </b><dd>
 A pointer to the object or 0, if the object name was not found. </dl>    </td>
  </tr>
</table>
<a name="a6" doxytag="ObjectManager::isValidObjectPointer"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
bool isValidObjectPointer (
          </b></td>
          <td valign="bottom"><b>
<a class="el" href="class_RoboticObject.html">RoboticObject</a> * <em>object</em>&nbsp;) const
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Checks the object list if a certain pointer is in there.
<p>
Note: Do not call this function if you have locked the object manager with a call of <a class="el" href="class_ObjectManager.html#a9">lockForRead</a>() and haven't unlocked it yet. <dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>object</em>
&nbsp;</td><td>
 Pointer to the object. </td></tr>
</table>
</dl><dl compact><dt>
<b>Returns: </b><dd>
 true: An object pointing to <em>object</em> exists, false: There is not object with pointer <em>object</em>. </dl>    </td>
  </tr>
</table>
<a name="a7" doxytag="ObjectManager::createDerivedObject"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
T * createDerivedObject (
          </b></td>
          <td valign="bottom"><b>
const char * <em>objectName</em>&nbsp;)<code> [inline]</code>
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function looks for an entry with the name <em>objectName</em> in the global configuration file that is derived from the class <em>T</em>. Then, it creates an object of the class listed in the global configuration file, sets the object name, and returns a pointer to the object.
<p>
The createDerivedObject functions are useful for generic programming, i.e., to write programs with knowing only the base class of objects. <dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>objectName</em>
&nbsp;</td><td>
 The name of the object, as listed in the global configuration file. </td></tr>
</table>
</dl><dl compact><dt>
<b>Returns: </b><dd>
 A pointer to the created object. 0 if the <em>objectName</em> could not be found in the configuration file or it was found but didn't have the base class <em>T</em>.
<p>
</dl><b>Example:</b>
<p>
<div class="fragment"><pre>     <font class="comment">// Close the grippers that are defined under the name</font>
     <font class="comment">// "punchy" and "grabby" in the global configuration file</font>
    
     <a class="code" href="class_ObjectManager.html">ObjectManager</a> om;
     Gripper *gripper1 = om.createDerivedObject&lt;Gripper&gt;(<font class="stringliteral">"punchy"</font>);
     Gripper *gripper2 = om.createDerivedObject&lt;Gripper&gt;(<font class="stringliteral">"grabby"</font>);
     gripper1-&gt;close();
     gripper2-&gt;close(); </div></pre>     </td>
  </tr>
</table>
<a name="a8" doxytag="ObjectManager::createDerivedObject"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
T * createDerivedObject (
          </b></td>
          <td valign="bottom"><b>
int <em>i</em> = 1&nbsp;)<code> [inline]</code>
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function looks for the <em>ith</em> entry in the global configuration file that specifies a class that is derived from the class <em>T</em>. Then, it creates an object of the class listed in the global configuration file, sets the object name, and returns a pointer to the object. <dl compact><dt>
<b>Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>i</em>
&nbsp;</td><td>
 The index of the entry in the global configuration file. Numbering starts at 0. </td></tr>
</table>
</dl><dl compact><dt>
<b>Returns: </b><dd>
 A pointer to the created object. 0 if there is no ith entry in the global configuration file that has the base class \T.
<p>
</dl><b>Example:</b>
<p>
<div class="fragment"><pre>     <font class="comment">// Operate the first two manipulators defined in the</font>
     <font class="comment">// global configuration file</font>
    
     <a class="code" href="class_ObjectManager.html">ObjectManager</a> om;
     Manipulator *m1 = om.createDerivedObject&lt;Manipulator&gt;(0);
     Manipulator *m2 = om.createDerivedObject&lt;Manipulator&gt;(1);    </div></pre>     </td>
  </tr>
</table>
<a name="a9" doxytag="ObjectManager::lockForRead"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
void lockForRead (
          </b></td>
          <td valign="bottom"><b>
) const
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Locks the object manager for reading of objects. This function  should always been called before working on an object or multiple objects of the object list to ensure that this object won't be deleted while operating on it. This function blocks if an object deletion is currently in progress. It won't block if other threads locked the object manager for reading. Note that it is also possible that new objects are added while the object manager is locked for reading. This won't interfere with reading the other objects, because objects are always added to the end of the object list. You must call <a class="el" href="class_ObjectManager.html#a10">unlock</a>() as quick as possible to avoid delaying other threads.     </td>
  </tr>
</table>
<a name="a10" doxytag="ObjectManager::unlock"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
void unlock (
          </b></td>
          <td valign="bottom"><b>
) const
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unlocks the object manager. Waiting threads  will be unblocked. This function must be called after a call to <a class="el" href="class_ObjectManager.html#a9">lockForRead</a>().     </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a name="m0" doxytag="ObjectManager::d_status"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td nowrap valign="top"><b> 
Status d_status
          </b></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The status of the object manager.     </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="ObjectManager_hpp-source.html">ObjectManager.hpp</a></ul>
</body>
</html>
