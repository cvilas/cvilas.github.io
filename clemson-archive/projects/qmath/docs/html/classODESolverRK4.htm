<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>QMath Matrix Library: ODESolverRK4&lt; T &gt; Class Template Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.6 -->
<div class="tabs">
  <ul>
    <li><a href="index.htm"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="annotated.htm"><span>Classes</span></a></li>
    <li><a href="files.htm"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.htm"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.htm"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.htm"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>ODESolverRK4&lt; T &gt; Class Template Reference</h1><!-- doxytag: class="ODESolverRK4" -->Solver for ordinary differential equations using 4th order Runge Kutta method.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="ODESolverRK4_8hpp-source.htm">ODESolverRK4.hpp</a>&gt;</code>
<p>
<a href="classODESolverRK4-members.htm">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODESolverRK4.htm#7b3ac63deccc3205e43b47922a75f8ff">ODESolverRK4</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODESolverRK4.htm#8e6a5f5f503a5cda2052aba123eb359f">ODESolverRK4</a> (double period, const T &amp;init)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODESolverRK4.htm#bb8d98918c9a99caa2891e592b3ded15">~ODESolverRK4</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODESolverRK4.htm#db574d20c768c3b1a563ce37e2494c2d">setSamplingPeriod</a> (double period)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODESolverRK4.htm#8db7e76085552696411466b380438343">setODE</a> (T(*diffFunc)(T &amp;, double t))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODESolverRK4.htm#2a4dbe3e919df4466a476ee1d5dee9f9">reset</a> (const T &amp;init)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual T&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classODESolverRK4.htm#14aee2d267f301bf0af23dc1a5113379">stepSolve</a> ()</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<h3>template&lt;class T = double&gt;<br>
 class ODESolverRK4&lt; T &gt;</h3>

Solver for ordinary differential equations using 4th order Runge Kutta method. 
<p>
Use this class for solving differential equations of the type x'(t) = f(x,t). The user must provide a function that returns x'(t) for any given x(t) and t.<p>
<b>Example Program:</b><p>
<div class="fragment"><pre class="fragment"><span class="comment">//======================================================================== </span>
<span class="comment">// Package                      : The Math Library - Ex</span>
<span class="comment">// Authors                      : Vilas Kumar Chitrakaran</span>
<span class="comment">// Start Date           : Wed Oct 28 11:08:28 GMT 2004</span>
<span class="comment">// Compiler                     : GNU C++ 2.95.3 and above</span>
<span class="comment">// ----------------------------------------------------------------------</span>
<span class="comment">// File: ODESolverRK4.t.cpp</span>
<span class="comment">// Example program for the ODESolverRK4 integrator.</span>
<span class="comment">//========================================================================</span>

<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;math.h&gt;</span>
<span class="preprocessor">#include "<a class="code" href="ODESolverRK4_8hpp.htm">ODESolverRK4.hpp</a>"</span>
<span class="preprocessor">#include "<a class="code" href="Vector_8hpp.htm">Vector.hpp</a>"</span>


<span class="comment">//========================================================================</span>
<span class="comment">// This program computes solution of a 2nd order differential equation</span>
<span class="comment">// numerically and compares result with analytical solution.</span>
<span class="comment">//========================================================================</span>


<span class="comment">//========================================================================</span>
<span class="comment">// Physical system - an mass-spring-damper.</span>
<span class="comment">// This function implements physical system as x' = f(x,t)</span>
<span class="comment">//========================================================================</span>
<a class="code" href="classVector.htm">Vector&lt;2&gt;</a> system(<a class="code" href="classVector.htm">Vector&lt;2&gt;</a> &amp;y, <span class="keywordtype">double</span> t)
{
 <a class="code" href="classVector.htm">Vector&lt;2&gt;</a> ydot;
 t = t;
 <span class="keywordtype">double</span> M = 1.0;  <span class="comment">// mass (kg)</span>
 <span class="keywordtype">double</span> K = 10.0; <span class="comment">// spring stiffness coefficient (N/m)</span>
 <span class="keywordtype">double</span> f = 2.0;  <span class="comment">// viscous friction coefficient (Ns/m)</span>
        
 <span class="comment">// system: mx'' + fx' + Kx = 0.</span>
 <span class="comment">// Write in state space form as</span>
 <span class="comment">// [y1dot; y2dot] = [-f/M, -K/M; 1, 0].[y1; y2]</span>
        
 ydot(1) = -(f/M) * y(1)  - (K/M) * y(2);
 ydot(2) = y(1);
        
 <span class="keywordflow">return</span> ydot;
}


<span class="comment">//========================================================================</span>
<span class="comment">// main function</span>
<span class="comment">//========================================================================</span>
<span class="keywordtype">int</span> main()
{
 FILE *outfile;
 <span class="keywordtype">double</span> dt = 0.001;                <span class="comment">// sampling time (s)</span>
 <a class="code" href="classVector.htm">Vector&lt;2&gt;</a> y;                      <span class="comment">// state vector ([velocity; position])</span>
 <a class="code" href="classVector.htm">Vector&lt;2&gt;</a> y_next_numerical;       <span class="comment">// numerical soln at next time step</span>
 <span class="keywordtype">double</span> y_next_analytical;         <span class="comment">// analytical soln at next time step</span>
 <a class="code" href="classODESolverRK4.htm">ODESolverRK4&lt; Vector&lt;2&gt;</a> &gt; solver; <span class="comment">// numerical solver</span>
        
 y = 2.0, 4.0; <span class="comment">// initial velocity and position</span>
                
 <span class="comment">// set up the solver</span>
 solver.<a class="code" href="classODESolverRK4.htm#8db7e76085552696411466b380438343">setODE</a>(system);
 solver.<a class="code" href="classODESolverRK4.htm#db574d20c768c3b1a563ce37e2494c2d">setSamplingPeriod</a>(dt);
 solver.<a class="code" href="classODESolverRK4.htm#2a4dbe3e919df4466a476ee1d5dee9f9">reset</a>(y);
        
 outfile = fopen(<span class="stringliteral">"ODESolverRK4.dat"</span>, <span class="stringliteral">"w+"</span>);

 <span class="comment">// Call integrate() every time-step </span>
 <span class="keywordtype">double</span> t = 0;
 <span class="keywordtype">double</span> error;
  
 y_next_numerical = y;
 y_next_analytical = y(2);
 fprintf(outfile, <span class="stringliteral">"%s\n%s %s %s\n"</span>, <span class="stringliteral">"%ODE Solver RK4 output file"</span>,
         <span class="stringliteral">"%analytical_output"</span>, <span class="stringliteral">"numerical_output"</span>, <span class="stringliteral">"error"</span> );
 <span class="keywordflow">for</span>(t = dt; t &lt; 10.0; t +=dt)
 {
  <span class="comment">// find error between analytical and numerical soln.</span>
  error = y_next_analytical - y_next_numerical(2);

  <span class="comment">// dump outputs in file</span>
  fprintf(outfile, <span class="stringliteral">"%f %f %f\n"</span>, y_next_analytical, y_next_numerical(2), error);
  
  <span class="comment">// analytical (actual) solution</span>
  y_next_analytical = exp(-t)*(4*cos(3 * t) + 2 * sin(3 * t));
                
  <span class="comment">// numerical solution</span>
  y_next_numerical = solver.<a class="code" href="classODESolverRK4.htm#14aee2d267f301bf0af23dc1a5113379">stepSolve</a>();
 }
        
 fclose(outfile);
 <span class="keywordflow">return</span>(0);
}


</pre></div> 
<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="7b3ac63deccc3205e43b47922a75f8ff"></a><!-- doxytag: member="ODESolverRK4::ODESolverRK4" ref="7b3ac63deccc3205e43b47922a75f8ff" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="mdPrefix" colspan="4">
template&lt;class T = double&gt; </td>
        </tr>
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="classODESolverRK4.htm">ODESolverRK4</a>&lt; T &gt;::<a class="el" href="classODESolverRK4.htm">ODESolverRK4</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The default constructor. The sampling period is set to default of 0.001 seconds The initial value is set to 0.     </td>
  </tr>
</table>
<a class="anchor" name="8e6a5f5f503a5cda2052aba123eb359f"></a><!-- doxytag: member="ODESolverRK4::ODESolverRK4" ref="8e6a5f5f503a5cda2052aba123eb359f" args="(double period, const T &amp;init)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="mdPrefix" colspan="4">
template&lt;class T = double&gt; </td>
        </tr>
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="classODESolverRK4.htm">ODESolverRK4</a>&lt; T &gt;::<a class="el" href="classODESolverRK4.htm">ODESolverRK4</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>period</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const T &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>init</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This constructor initializes the sampling period and initial Value. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>period</em>&nbsp;</td><td>The sampling period in seconds. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>init</em>&nbsp;</td><td>The initial value. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="bb8d98918c9a99caa2891e592b3ded15"></a><!-- doxytag: member="ODESolverRK4::~ODESolverRK4" ref="bb8d98918c9a99caa2891e592b3ded15" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="mdPrefix" colspan="4">
template&lt;class T = double&gt; </td>
        </tr>
        <tr>
          <td class="md" nowrap valign="top">virtual <a class="el" href="classODESolverRK4.htm">ODESolverRK4</a>&lt; T &gt;::~<a class="el" href="classODESolverRK4.htm">ODESolverRK4</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="db574d20c768c3b1a563ce37e2494c2d"></a><!-- doxytag: member="ODESolverRK4::setSamplingPeriod" ref="db574d20c768c3b1a563ce37e2494c2d" args="(double period)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="mdPrefix" colspan="4">
template&lt;class T = double&gt; </td>
        </tr>
        <tr>
          <td class="md" nowrap valign="top">void <a class="el" href="classODESolverRK4.htm">ODESolverRK4</a>&lt; T &gt;::setSamplingPeriod           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>period</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The default destructor Sets the sampling period of the solver     </td>
  </tr>
</table>
<a class="anchor" name="8db7e76085552696411466b380438343"></a><!-- doxytag: member="ODESolverRK4::setODE" ref="8db7e76085552696411466b380438343" args="(T(*diffFunc)(T &amp;, double t))" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="mdPrefix" colspan="4">
template&lt;class T = double&gt; </td>
        </tr>
        <tr>
          <td class="md" nowrap valign="top">void <a class="el" href="classODESolverRK4.htm">ODESolverRK4</a>&lt; T &gt;::setODE           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">T(*)(T &amp;, double t)&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>diffFunc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the differential equation of the form x'=f(x,t) to evaluate. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>diffFunc</em>&nbsp;</td><td>The differential equation </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="2a4dbe3e919df4466a476ee1d5dee9f9"></a><!-- doxytag: member="ODESolverRK4::reset" ref="2a4dbe3e919df4466a476ee1d5dee9f9" args="(const T &amp;init)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="mdPrefix" colspan="4">
template&lt;class T = double&gt; </td>
        </tr>
        <tr>
          <td class="md" nowrap valign="top">virtual void <a class="el" href="classODESolverRK4.htm">ODESolverRK4</a>&lt; T &gt;::reset           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const T &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>init</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function resets the output of the solver to <em>init</em> and further integration restarts from this initial value.     </td>
  </tr>
</table>
<a class="anchor" name="14aee2d267f301bf0af23dc1a5113379"></a><!-- doxytag: member="ODESolverRK4::stepSolve" ref="14aee2d267f301bf0af23dc1a5113379" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="mdPrefix" colspan="4">
template&lt;class T = double&gt; </td>
        </tr>
        <tr>
          <td class="md" nowrap valign="top">virtual T <a class="el" href="classODESolverRK4.htm">ODESolverRK4</a>&lt; T &gt;::stepSolve           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find solution for the next time step. <dl compact><dt><b>Returns:</b></dt><dd>The integrated value for the next step </dd></dl>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="ODESolverRK4_8hpp-source.htm">ODESolverRK4.hpp</a></ul>
<hr>
Created for project <code><font color="red"><b>QMath Matrix Library</b></font></code> on Mon Sep 11 14:52:24 EDT 2006
<br>
 for Vilas Kumar Chitrakaran (cvilas(@)ces.clemson.edu). 
<br>
Documentation generated using <a href=http://www.doxygen.org>Doxygen</a>
.
</body>
</html>
