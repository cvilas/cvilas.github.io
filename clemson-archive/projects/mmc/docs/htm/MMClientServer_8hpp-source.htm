<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Motion Mind DC Motor Controller 1.0: MMClientServer.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.6 -->
<div class="tabs">
  <ul>
    <li><a href="index.htm"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.htm"><span>Classes</span></a></li>
    <li id="current"><a href="files.htm"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.htm"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.htm"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>MMClientServer.hpp</h1><a href="MMClientServer_8hpp.htm">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001   
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#ifndef INCLUDED_MMCLIENTSERVER_HPP</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="preprocessor">#define INCLUDED_MMCLIENTSERVER_HPP</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span>
<a name="l00006"></a>00006 <span class="preprocessor">#include "<a class="code" href="MotionMind_8hpp.htm">MotionMind.hpp</a>"</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include "putils/ShMem.hpp"</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include "putils/StatusReport.hpp"</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;time.h&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;signal.h&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;semaphore.h&gt;</span>
<a name="l00012"></a>00012 
<a name="l00013"></a><a class="code" href="MMClientServer_8hpp.htm#d75a8c12c8aa34a96188ad22b7d0c3c0">00013</a> <span class="preprocessor">#define MMCHANGESPEED 0x01</span>
<a name="l00014"></a><a class="code" href="MMClientServer_8hpp.htm#b57754afed56aec11b767f8d9000e9ab">00014</a> <span class="preprocessor"></span><span class="preprocessor">#define MMMOVETOABS   0x02</span>
<a name="l00015"></a><a class="code" href="MMClientServer_8hpp.htm#c26c8d7b50e0273020d2ade8e4268a70">00015</a> <span class="preprocessor"></span><span class="preprocessor">#define MMMOVETOREL   0x03</span>
<a name="l00016"></a><a class="code" href="MMClientServer_8hpp.htm#9bb382c47d00d29fa61214ed9473a556">00016</a> <span class="preprocessor"></span><span class="preprocessor">#define MMMOVEATVEL   0x04</span>
<a name="l00017"></a>00017 <span class="preprocessor"></span>
<a name="l00018"></a><a class="code" href="structMMCommand.htm">00018</a> <span class="keyword">struct </span><a class="code" href="structMMCommand.htm">MMCommand</a>
<a name="l00019"></a>00019 {
<a name="l00020"></a><a class="code" href="structMMCommand.htm#938fe25c7faadf3a00f0a1704a64e601">00020</a>   sem_t <a class="code" href="structMMCommand.htm#938fe25c7faadf3a00f0a1704a64e601">guard</a>;      <span class="comment">// semaphore</span>
<a name="l00021"></a><a class="code" href="structMMCommand.htm#349c974534158132eaf3a622b43da550">00021</a>   <span class="keywordtype">char</span> <a class="code" href="structMMCommand.htm#349c974534158132eaf3a622b43da550">command</a>;     <span class="comment">// command byte</span>
<a name="l00022"></a><a class="code" href="structMMCommand.htm#1dc942920708a69d204ff2c45d9c2211">00022</a>   int32_t <a class="code" href="structMMCommand.htm#1dc942920708a69d204ff2c45d9c2211">data</a>;     <span class="comment">// data byte</span>
<a name="l00023"></a><a class="code" href="structMMCommand.htm#fa337726c045b2203671e4f7ba4bc74a">00023</a>   int32_t <a class="code" href="structMMCommand.htm#fa337726c045b2203671e4f7ba4bc74a">position</a>; <span class="comment">// motor position update</span>
<a name="l00024"></a><a class="code" href="structMMCommand.htm#50c73a3061eb496f804b84a3d7ac980e">00024</a>   <span class="keywordtype">char</span> <a class="code" href="structMMCommand.htm#50c73a3061eb496f804b84a3d7ac980e">status</a>;      <span class="comment">// server status, 0 if OK, -1 if error</span>
<a name="l00025"></a>00025 };
<a name="l00026"></a>00026 
<a name="l00040"></a><a class="code" href="classMMClient.htm">00040</a> <span class="keyword">class </span><a class="code" href="classMMClient.htm">MMClient</a>
<a name="l00041"></a>00041 {
<a name="l00042"></a>00042   <span class="keyword">public</span>:
<a name="l00043"></a>00043     <a class="code" href="classMMClient.htm#1a7ba1f080f0e99c2df684e99803e06e">MMClient</a>(<span class="keywordtype">char</span> *shmName = <span class="stringliteral">"mmc0"</span>);
<a name="l00048"></a>00048     <a class="code" href="classMMClient.htm#fe725c12abcd46d6f584248e2944e8ef">~MMClient</a> ();
<a name="l00052"></a>00052     <span class="keywordtype">int</span> <a class="code" href="classMMClient.htm#1fb25e09105802c6183fc01e917cedf2">isServerStatusOk</a>();
<a name="l00056"></a>00056     <span class="keywordtype">void</span> <a class="code" href="classMMClient.htm#1207618fb6d94659ccc9542fd2b72b3b">changeSpeed</a>(int16_t speed);
<a name="l00068"></a>00068     <span class="keywordtype">void</span> <a class="code" href="classMMClient.htm#66eaf83577930d1c69115c57b45b09d0">moveToAbsolute</a>(int32_t position);
<a name="l00081"></a>00081     <span class="keywordtype">void</span> <a class="code" href="classMMClient.htm#73492b723ef0567ec2cfa4852ed4c33c">moveToRelative</a>(int32_t position);
<a name="l00094"></a>00094     <span class="keywordtype">void</span> <a class="code" href="classMMClient.htm#b7638cc99a34549f41016d4072d2444f">moveAtVelocity</a>(int16_t velocity);
<a name="l00106"></a>00106     int32_t <a class="code" href="classMMClient.htm#ea97c8e93cd79d16c4006721ff6dcbea">getPosition</a>();
<a name="l00114"></a>00114   <span class="keyword">protected</span>:
<a name="l00115"></a>00115   <span class="keyword">private</span>:
<a name="l00116"></a>00116     ShMem d_shm;
<a name="l00117"></a>00117     <span class="keyword">struct </span><a class="code" href="structMMCommand.htm">MMCommand</a> *d_data;
<a name="l00118"></a>00118     <span class="keywordtype">int</span> d_serverStatus;
<a name="l00119"></a>00119     int32_t d_position;
<a name="l00120"></a>00120 };
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 
<a name="l00135"></a><a class="code" href="classMMServer.htm">00135</a> <span class="keyword">class </span><a class="code" href="classMMServer.htm">MMServer</a>
<a name="l00136"></a>00136 {
<a name="l00137"></a>00137   <span class="keyword">public</span>:
<a name="l00138"></a>00138     <a class="code" href="classMMServer.htm#c69f4f5274d4dc52e8adecbce1ed0b1a">MMServer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *serverName, <span class="keyword">const</span> <span class="keywordtype">char</span> *port, <span class="keywordtype">int</span> baud, <span class="keywordtype">int</span> address, <span class="keywordtype">bool</span> verbose=<span class="keyword">true</span>);
<a name="l00154"></a>00154     <a class="code" href="classMMServer.htm#b6bf312aa5d8bdc48f8303d3254b1456">~MMServer</a> ();
<a name="l00158"></a>00158     <span class="keywordtype">int</span> <a class="code" href="classMMServer.htm#791e90142be6dae7be7f3cfa78e7d934">getStatusCode</a>() <span class="keyword">const</span>;
<a name="l00162"></a>00162     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classMMServer.htm#2720c83bcc2267d3ae887ac2ab7b5e89">getStatusMessage</a>() <span class="keyword">const</span>;
<a name="l00166"></a>00166     <span class="keywordtype">int</span> <a class="code" href="classMMServer.htm#a719540ef7b316dae7334b704832201d">setPIDGains</a>(<span class="keywordtype">int</span> p, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> d);
<a name="l00171"></a>00171     <span class="keywordtype">void</span> <a class="code" href="classMMServer.htm#efd9cf0713304ae491568ec061351fee">doMainLoop</a>(<span class="keywordtype">int</span> updateDelay);
<a name="l00177"></a>00177   <span class="keyword">protected</span>:
<a name="l00178"></a>00178   <span class="keyword">private</span>:
<a name="l00179"></a>00179     <span class="keyword">static</span> <span class="keywordtype">void</span> signalHandler(<span class="keywordtype">int</span> signal);
<a name="l00182"></a>00182   <span class="keyword">static</span> <span class="keywordtype">bool</span> d_terminate;
<a name="l00183"></a>00183     ShMem d_shm;
<a name="l00184"></a>00184     <a class="code" href="classMotionMind.htm">MotionMind</a> d_controller;
<a name="l00185"></a>00185     <span class="keyword">struct </span><a class="code" href="structMMCommand.htm">MMCommand</a> *d_data;
<a name="l00186"></a>00186     StatusReport d_status;
<a name="l00187"></a>00187 };
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 <span class="preprocessor">#endif // INCLUDED_MMCLIENTSERVER_HPP</span>
<a name="l00191"></a>00191 <span class="preprocessor"></span>
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 
</pre></div><hr>
Created for project <code><font color="red"><b>Motion Mind DC Motor Controller</b></font></code> on Tue Apr 11 14:51:00 EDT 2006
<br>
 for Vilas Kumar Chitrakaran (cvilas(@)ces.clemson.edu). 
<br>
Documentation generated using <a href=http://www.doxygen.org>Doxygen</a>
.
</body>
</html>
